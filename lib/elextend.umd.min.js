(function(t,e){"object"===typeof exports&&"object"===typeof module?module.exports=e(require("moment")):"function"===typeof define&&define.amd?define(["moment"],e):"object"===typeof exports?exports["elextend"]=e(require("moment")):t["elextend"]=e(t["moment"])})("undefined"!==typeof self?self:this,function(t){return function(t){var e={};function a(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=t,a.c=e,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)a.d(n,r,function(e){return t[e]}.bind(null,r));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s="fb15")}({"00fd":function(t,e,a){var n=a("9e69"),r=Object.prototype,i=r.hasOwnProperty,o=r.toString,s=n?n.toStringTag:void 0;function l(t){var e=i.call(t,s),a=t[s];try{t[s]=void 0;var n=!0}catch(l){}var r=o.call(t);return n&&(e?t[s]=a:delete t[s]),r}t.exports=l},1308:function(t,e,a){},1310:function(t,e){function a(t){return null!=t&&"object"==typeof t}t.exports=a},"1a8c":function(t,e){function a(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}t.exports=a},"211a":function(t,e,a){"use strict";var n=a("d7d9"),r=a.n(n);r.a},"29f3":function(t,e){var a=Object.prototype,n=a.toString;function r(t){return n.call(t)}t.exports=r},"2b3e":function(t,e,a){var n=a("585a"),r="object"==typeof self&&self&&self.Object===Object&&self,i=n||r||Function("return this")();t.exports=i},3729:function(t,e,a){var n=a("9e69"),r=a("00fd"),i=a("29f3"),o="[object Null]",s="[object Undefined]",l=n?n.toStringTag:void 0;function c(t){return null==t?void 0===t?s:o:l&&l in Object(t)?r(t):i(t)}t.exports=c},3941:function(t,e,a){"use strict";var n=a("8eb8"),r=a.n(n);r.a},"408c":function(t,e,a){var n=a("2b3e"),r=function(){return n.Date.now()};t.exports=r},"463e":function(t,e,a){"use strict";var n=a("e655"),r=a.n(n);r.a},"585a":function(t,e,a){(function(e){var a="object"==typeof e&&e&&e.Object===Object&&e;t.exports=a}).call(this,a("c8ba"))},8855:function(t,e,a){},"8eb8":function(t,e,a){},"9e69":function(t,e,a){var n=a("2b3e"),r=n.Symbol;t.exports=r},b047:function(t,e,a){var n=a("1a8c"),r=a("408c"),i=a("b4b0"),o="Expected a function",s=Math.max,l=Math.min;function c(t,e,a){var c,u,f,d,h,p,m=0,g=!1,v=!1,b=!0;if("function"!=typeof t)throw new TypeError(o);function _(e){var a=c,n=u;return c=u=void 0,m=e,d=t.apply(n,a),d}function y(t){return m=t,h=setTimeout(S,e),g?_(t):d}function w(t){var a=t-p,n=t-m,r=e-a;return v?l(r,f-n):r}function $(t){var a=t-p,n=t-m;return void 0===p||a>=e||a<0||v&&n>=f}function S(){var t=r();if($(t))return x(t);h=setTimeout(S,w(t))}function x(t){return h=void 0,b&&c?_(t):(c=u=void 0,d)}function C(){void 0!==h&&clearTimeout(h),m=0,c=p=u=h=void 0}function P(){return void 0===h?d:x(r())}function k(){var t=r(),a=$(t);if(c=arguments,u=this,p=t,a){if(void 0===h)return y(p);if(v)return h=setTimeout(S,e),_(p)}return void 0===h&&(h=setTimeout(S,e)),d}return e=i(e)||0,n(a)&&(g=!!a.leading,v="maxWait"in a,f=v?s(i(a.maxWait)||0,e):f,b="trailing"in a?!!a.trailing:b),k.cancel=C,k.flush=P,k}t.exports=c},b4b0:function(t,e,a){var n=a("1a8c"),r=a("ffd6"),i=NaN,o=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,c=/^0o[0-7]+$/i,u=parseInt;function f(t){if("number"==typeof t)return t;if(r(t))return i;if(n(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=n(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(o,"");var a=l.test(t);return a||c.test(t)?u(t.slice(2),a?2:8):s.test(t)?i:+t}t.exports=f},c32d:function(e,a){e.exports=t},c8ba:function(t,e){var a;a=function(){return this}();try{a=a||Function("return this")()||(0,eval)("this")}catch(n){"object"===typeof window&&(a=window)}t.exports=a},d1b8:function(t,e,a){"use strict";var n=a("8855"),r=a.n(n);r.a},d7d9:function(t,e,a){},e655:function(t,e,a){},f16e:function(t,e,a){"use strict";var n=a("1308"),r=a.n(n);r.a},fb15:function(t,e,a){"use strict";var n;(a.r(e),"undefined"!==typeof window)&&((n=window.document.currentScript)&&(n=n.src.match(/(.+\/)[^\/]+\.js(\?.*)?$/))&&(a.p=n[1]));var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table-extend"},[t.show.searchShow?a("el-form",t._g(t._b({ref:"form",attrs:{model:t.form}},"el-form",t.formConfig.$attr,!1),t.formConfig.$listener),[a("div",{staticClass:"__table-extend_search_wrapper"},[a("div",{staticClass:"__table-extend_search_content",style:{flex:t.searchConfig.flex}},t._l(t.formItem,function(e,n){var r=e.prop,i=e.method,o=e.span,s=e.labelWidth,l=e.label,c=e.$attr,u=e.$listener;return a("div",{key:n,style:{flex:o}},[a("el-form-item",{attrs:{"label-width":s,label:l,prop:r}},[t._t("search-"+r,["input"===i?a("el-input",t._g(t._b({staticStyle:{width:"100%"},model:{value:t.form[r],callback:function(e){t.$set(t.form,r,"string"===typeof e?e.trim():e)},expression:"form[prop]"}},"el-input",c,!1),u)):"select"===i?a("lxt-select",t._g(t._b({staticStyle:{width:"100%"},attrs:{value:t.form[r]},on:{"update:value":function(e){t.$set(t.form,r,e)}}},"lxt-select",c,!1),u)):"cascader"===i?a("cascader",t._g(t._b({staticStyle:{width:"100%"},attrs:{value:t.form[r]},on:{"update:value":function(e){t.$set(t.form,r,e)}}},"cascader",c,!1),u)):"datePicker"===i?a("date-picker",t._g(t._b({staticStyle:{width:"100%"},attrs:{value:t.form[r]},on:{"update:value":function(e){t.$set(t.form,r,e)}}},"date-picker",c,!1),u)):"datePickerCustom"===i?a("date-picker-custom",t._g(t._b({attrs:{value:t.form[r]},on:{"update:value":function(e){t.$set(t.form,r,e)}}},"date-picker-custom",c,!1),u)):"customHourMin"===i?a("custom-hour-min",t._g(t._b({attrs:{value:t.form[r]},on:{"update:value":function(e){t.$set(t.form,r,e)}}},"custom-hour-min",c,!1),u)):t._e()],null,t.form[r])],2)],1)})),a("div",{staticClass:"__table-extend_search_btn"},[a("el-button",{attrs:{type:"primary",round:""},on:{click:function(e){t.searchHandle(t.form)}}},[t._v("搜索")]),t.searchConfig.resetButton?a("el-button",{attrs:{type:"primary",plain:"",round:""},on:{click:t.resetHandle}},[t._v("重置")]):t._e()],1)])]):t._e(),t._t("middle",null,null,{form:t.request,table:t.tableCache.data}),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"__table-extend_table_layout"},[a("div",{staticClass:"__middle_search_table"},[t.show.paginationShow?a("span",[t._v("共查询到"+t._s(t.tableCache.total)+"个结果")]):t._e(),a("div",{staticClass:"__middle_search_table_slot"},[t._t("default",null,null,{form:t.request,table:t.tableCache.data})],2)]),t.show.tableShow?a("div",{staticClass:"__table-extend_table_wrapper"},[a("el-table",t._g(t._b({staticStyle:{width:"100%"},attrs:{data:t.tableCache.data}},"el-table",t.table.$attr,!1),t.table.$listener),t._l(t.column,function(e,n){var r=e.$attr,i=e.$listener;return a("el-table-column",t._g(t._b({key:n,attrs:{"header-align":t.table.$attr.headerAlign,"show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._t("table-"+r.prop,[t._v("\n                    "+t._s("index"===r.type?e.$index+1:e.row[r.prop])+"\n                ")],null,{scope:e,form:t.request})]}}])},"el-table-column",r,!1),i))}))],1):t._e(),t.show.paginationShow?a("div",{staticClass:"__table-extend_pagination_wrapper"},[a("el-pagination",t._g(t._b({attrs:{total:t.tableCache.total,"current-page":t.pageParams.pageNo,"page-size":t.pageParams.pageSize},on:{"update:currentPage":function(e){t.$set(t.pageParams,"pageNo",e)},"current-change":t.currentChange,"size-change":t.sizeChange}},"el-pagination",t.pagination.$attr,!1),t.pagination.$listener),[t._t("pagination")],2)],1):t._e()])],2)},i=[],o=a("b047"),s=a.n(o),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-select",t._g(t._b({attrs:{loading:t.loading,"remote-method":t.remoteMethod},model:{value:t.val,callback:function(e){t.val=e},expression:"val"}},"el-select",t.$attrs,!1),t.$listeners),t._l(t.option,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))},c=[];const u=t=>Object.prototype.toString.call(t),f=t=>{return"[object Array]"===u(t)},d=t=>{return"[object Object]"===u(t)};function h(t){const[e,a={},n=(t=>t)]=t;return{handle:e,path:a,fn:n}}function p(t,e){if(!e)throw new Error("path结构和api数据结构有点对不上啊！老铁");let a=Object.create(null);const n=Object.keys(t);for(const r of n)e[r]instanceof Object&&!Array.isArray(e[r])?a={...a,...p(t[r],e[r])}:a[r]=e[t[r]];return a}function m(t){const e={},a={};return t.forEach(({prop:t,strategy:n,$default:r})=>{e[t]=n,a[t]=r||""}),{merge:e,form:a}}function g(t,e){for(const a in e)t[a]=d(e[a])?g(t[a],e[a]):e[a];return t}function v(t,e){if(void 0===e)return t;const a=Object.keys(t);for(const n of a)"$attr"===n||"$listener"===n?t[n]={...t[n],...e[n]}:"formItem"===n?t[n]=e[n].map(e=>{const{method:a}=e;return g({...t[n][a]||t[n].methodDefault},{...e})}):d(t[n])?t[n]=v(t[n],e[n]):e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function b(t){return new Promise(e=>{const{port1:a,port2:n}=new MessageChannel;n.onmessage=(t=>e(t.data)),a.postMessage(t)})}var _={data(){return{option:[],loading:!1}},props:["value","options"],computed:{val:{get(){return this.value},set(t){this.handlerValue(t)}}},async created(){const{remote:t,filterable:e}=this.$attrs;if(t&&e)return;const a=this.options&&this.options[0];this.option="function"!==typeof a?a:await this.getOption(this.options)},methods:{handlerValue(t){this.$emit("update:value",t)},async getOption(t,e=""){const{handle:a,path:n,fn:r}=h(t),i=await a(e),o=p(n,i);return o.data.map(r)},async remoteMethod(t){this.loading=!0,this.option=await this.getOption(this.options,t),this.loading=!1}}},y=_;a("f16e");function w(t,e,a,n,r,i,o,s){var l,c="function"===typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=a,c._compiled=!0),n&&(c.functional=!0),i&&(c._scopeId="data-v-"+i),o?(l=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),r&&r.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(o)},c._ssrRegister=l):r&&(l=s?function(){r.call(this,this.$root.$options.shadowRoot)}:r),l)if(c.functional){c._injectStyles=l;var u=c.render;c.render=function(t,e){return l.call(e),u(t,e)}}else{var f=c.beforeCreate;c.beforeCreate=f?[].concat(f,l):[l]}return{exports:t,options:c}}var $=w(y,l,c,!1,null,null,null);$.options.__file="select.vue";var S=$.exports,x=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-cascader",t._g(t._b({attrs:{options:t.option},model:{value:t.val,callback:function(e){t.val=e},expression:"val"}},"el-cascader",t.$attrs,!1),t.$listeners))},C=[],P={data(){return{option:[],loading:!1}},props:["value","options"],computed:{val:{get(){return this.value},set(t){this.handlerValue(t)}}},async created(){this.option=await this.getOption(this.options)},methods:{handlerValue(t){this.$emit("update:value",t)},async getOption(t){const{handle:e,path:a,fn:n}=h(t),r=await e(),i=p(a,r);return i.data.map(n)}}},k=P,j=(a("3941"),w(k,x,C,!1,null,null,null));j.options.__file="cascader.vue";var O=j.exports,T=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-date-picker",t._g(t._b({model:{value:t.timePicker,callback:function(e){t.timePicker=e},expression:"timePicker"}},"el-date-picker",t.$attrs,!1),t.$listeners))},D=[],M={data(){return{}},props:["value"],computed:{timePicker:{get(){return this.value},set(t){this.formatTimePicker(t)}}},methods:{formatTimePicker(t){this.$emit("update:value",t)}}},q=M,H=(a("211a"),w(q,T,D,!1,null,null,null));H.options.__file="datePicker.vue";var N=H.exports,E=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"datePicker"},[a("el-date-picker",t._g(t._b({staticStyle:{width:"100%",border:"none"},attrs:{type:t.type},model:{value:t.timePicker,callback:function(e){t.timePicker=e},expression:"timePicker"}},"el-date-picker",t.$attrs,!1),t.$listeners)),a("div",t._l(t.days,function(e,n){return a("el-button",{key:n,staticClass:"datePicker-btn",class:{actived:t.day===e},attrs:{size:"mini"},on:{click:function(a){t.timePick(e)}}},[t._v("\n\t\t\t"+t._s("近"+e+"天")+"\n\t\t")])}))],1)},Y=[],z=a("c32d"),F=a.n(z);function I(t){return[F()().subtract(t,"days").format("YYYY-MM-DD"),F()().format("YYYY-MM-DD")]}function A(t){return[F()().subtract(t,"days").format("YYYY-MM-DD HH:mm:ss"),F()().format("YYYY-MM-DD HH:mm:ss")]}function R([t,e]=[]){return F()().isSame(e,"day")?F()().diff(t,"days"):0}var V={data(){return{day:this.defaultDay}},props:["value","days","defaultDay","type"],computed:{timePicker:{get(){return this.day=R(this.value),this.value},set(t){t||(t=[]),this.formatTimePicker(t)}}},methods:{formatTimePicker(t){this.$emit("update:value",t)},timePick(t){this.day=t,this.timePicker="daterange"===this.type?I(t):A(t)}}},U=V,W=(a("d1b8"),w(U,E,Y,!1,null,null,null));W.options.__file="datePickerCustom.vue";var B=W.exports,L=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"customHourMin"},[a("el-input",{attrs:{min:0},on:{change:function(e){t.computeTime(t.day,t.hour)}},model:{value:t.day,callback:function(e){t.day=t._n(e)},expression:"day"}}),t._v("天"),a("el-input",{on:{change:function(e){t.computeTime(t.day,t.hour)}},model:{value:t.hour,callback:function(e){t.hour=t._n(e)},expression:"hour"}}),t._v("小时及以上\n\t"),a("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[t._v(t._s(t.value))])],1)},X=[],Z={data(){return{hour:"",day:""}},props:["value"],methods:{formatterTime(t){let e=t/3600;const a=Math.floor(e/24);e%=24,this.day=a,this.hour=e},computeTime(t,e){if(Number.isNaN(t))return void(this.day=0);if(Number.isNaN(e))return void(this.hour=0);const a=24*t*3600+3600*e;this.$emit("update:value",a),this.formatterTime(a)}}},G=Z,J=(a("463e"),w(G,L,X,!1,null,null,null));J.options.__file="customHourMin.vue";var K=J.exports,Q={searchConfig:{searchShow:!0,resetButton:!0,flex:"1",form:{$attr:{size:"small",labelWidth:"68px"},$listener:{}},formItem:{input:{strategy:t=>t,$default:"",span:1,$attr:{},$listener:{}},select:{strategy:t=>t,span:1,$default:"",$attr:{},$listener:{}},datePicker:{strategy:([t,e])=>({startDate:t,endDate:e}),$default:"",span:1,$attr:{type:"datetimerange",startPlaceholder:"开始时间",endPlaceholder:"结束时间"},$listener:{}},cascader:{strategy:([t,e=null])=>({platform:t,roleId:e}),$default:[],span:1,$attr:{clearable:!0},$listener:{}},datePickerCustom:{strategy:([t,e])=>({startDate:t,endDate:e}),$default:"",span:1,$attr:{type:"datetimerange","start-placeholder":"开始时间","end-placeholder":"结束时间",days:[],defaultDay:0},$listener:{}},methodDefault:{strategy:t=>t,$default:"",span:1,$attr:{},$listener:{}}}},tableConfig:{tableShow:!0,table:{$attr:{border:!0,headerAlign:"center"},$listener:{}},column:[]},pagination:{paginationShow:!0,$listener:{},pageParams:{pageNo:1,pageSize:10},$attr:{pageSizes:[5,10,20],background:!0,layout:"prev, pager, next, sizes, jumper"}}},tt={name:"ElExtendDataRenderTable",data(){return{loading:!1,tableCache:{},searchConfig:{},onceSreach:[],form:{},initForm:{},pageInitParams:{},pageParams:{},request:{},requestStrategy:"",show:{searchShow:!1,tableShow:!1,paginationShow:!1},formConfig:"",formItem:"",column:"",table:"",pagination:""}},props:{api:Array,config:Object,auto:{type:Boolean,default:!0}},components:{LxtSelect:S,DatePicker:N,DatePickerCustom:B,CustomHourMin:K,Cascader:O},created(){this.mergeConfig(),this.$root.$on("elDateFrom",t=>{this.form={...this.form,...t}})},mounted(){this.auto&&this.searchHandle(this.form)},methods:{insertHandler(...t){const[e,...a]=t;this.onceSreach=a,this.form={...e},this.searchHandle(this.form)},insertHandlerNotRefresh(){this.debounce(this.request)},async beforeSearchhandler(t){let e=null;return this.tableCache={},this.resetCurrentPageAndPageSize(),e=await this.mergeStrategiesFn(t),e},async camelCaseToUnderline(t){const e={};for(const a of Object.keys(t))e[a.replace(/([A-Z])/g,"_$1").toLowerCase()]=t[a];return e},async afterSearchhandler(){await this.unbindForm()},async unbindForm(){this.onceSreach.forEach(t=>delete this.form[t])},async searchHandle(t){if(this.loading)return;let e=null;e=await this.beforeSearchhandler(t),this.auto?this.request={...e,...this.pageParams}:this.request={...e},await this.debounce(this.request),await this.afterSearchhandler()},async mergeStrategiesFn(t){let e={};for(const a of Object.keys(t))f(t[a])?e={...e,...this.requestStrategy[a]&&this.requestStrategy[a](t[a])}:e[a]=this.requestStrategy[a]?this.requestStrategy[a](t[a]):t[a];return e},async resetHandle(){this.loading||(this.$emit("resetHandler"),this.form={...this.initForm},this.auto&&await this.searchHandle(this.form))},loadingSwitch(){this.loading=!this.loading},resetCurrentPageAndPageSize(){this.pageParams={...this.pagination.pageParams}},async currentChange(t){this.pageParams={...this.pageParams,pageNo:t},await this.debounce({...this.request,...this.pageParams})},async sizeChange(t){this.pageParams={...this.pageParams,pageSize:t},await this.debounce({...this.request,...this.pageParams})},async getData(t){this.loadingSwitch();const{handle:e,path:a}=h(this.api);try{const r=await e(t);this.tableCache=p(a,r)}catch(n){console.log(n)}finally{this.loadingSwitch()}},debounce:s()(function(t){this.getData(t)},300),async mergeConfig(){const t=await b(Q),e=v(t,this.config),{merge:a,form:n}=m(e.searchConfig.formItem);this.requestStrategy=a,this.form={...n},this.initForm={...n},this.show={searchShow:e.searchConfig.searchShow,tableShow:e.tableConfig.tableShow,paginationShow:e.pagination.paginationShow},this.searchConfig=e.searchConfig,this.formConfig=e.searchConfig.form,this.formItem=e.searchConfig.formItem,this.column=e.tableConfig.column,this.table=e.tableConfig.table,this.pagination=e.pagination,this.show.paginationShow&&(this.pageParams={...this.pagination.pageParams})}}},et=tt,at=w(et,r,i,!1,null,null,null);at.options.__file="data-render-table.vue";var nt=at.exports;nt.instabll=function(t){t.component(nt.name,nt)};var rt=nt;const it=[rt],ot=function(t){ot.installed||it.map(e=>t.component(e.name,e))};"undefined"!==typeof window&&window.Vue&&ot(window.Vue);var st={install:ot,dataRenderTable:rt};e["default"]=st},ffd6:function(t,e,a){var n=a("3729"),r=a("1310"),i="[object Symbol]";function o(t){return"symbol"==typeof t||r(t)&&n(t)==i}t.exports=o}})});
//# sourceMappingURL=elextend.umd.min.js.map